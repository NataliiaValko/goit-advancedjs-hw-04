{"version":3,"file":"commonHelpers.js","sources":["../src/js/apiPixabay.js","../src/js/refs.js","../src/js/helpers.js","../src/service/markupService.js","../src/js/gallery.js"],"sourcesContent":["import axios from 'axios';\n\nexport default class NewApiPixabay {\n  #BASE_URL = 'https://pixabay.com/api/';\n  #KEY = '31000801-179358ed9db1a9fc0904af43d';\n  #valueForSearch;\n  #page;\n\n  constructor() {\n    this.#valueForSearch = '';\n    this.#page = 1;\n    this.perPage = 40;\n  }\n\n  fetchGallery() {\n    return axios.get(`${this.#BASE_URL}`, {\n      params: {\n        key: this.#KEY,\n        q: this.#valueForSearch,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: this.perPage,\n        page: this.#page,\n      },\n    });\n  }\n\n  get valueForSearch() {\n    return this.#valueForSearch;\n  }\n\n  set valueForSearch(value) {\n    this.#valueForSearch = value;\n  }\n\n  get page() {\n    return this.#page;\n  }\n\n  set page(p) {\n    this.#page += 1;\n  }\n\n  resetPage() {\n    this.#page = 1;\n  }\n}\n","export const refs = {\n  form: document.querySelector('#search-form'),\n  input: document.querySelector('.search-form__input'),\n  btnClose: document.querySelector('.search-form__button'),\n  targetObserver: document.querySelector('.target-element'),\n  gallery: document.querySelector('.gallery__list'),\n  btnLoadMore: document.querySelector('.load-more'),\n};\n","import { refs } from './refs';\nexport const getValidateArray = array => {\n  return array.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      return {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      };\n    }\n  );\n};\n\nexport const checkVisibleLoadMore = ({ page, totalHits, perPage }) => {\n  return page < Math.ceil(totalHits / perPage);\n};\n\nexport const scrollPage = () => {\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n","export const makeGalleryMarkup = (array, target) => {\n  const markup = array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery__item gallery\">\n      <a class=\"gallery__link\" href=\"${largeImageURL}\">\n      <img class=\"gallery__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=400/>\n      </a>\n      <div class=\"gallery__info\">\n      <ul class=\"gallery__details-list\"><li class=\"gallery__details-item\"><p class=\"gallery__details\">\n          <b>Likes</b>\n          ${likes}\n        </p></li>\n        <li class=\"gallery__details-item\"><p class=\"gallery__details\">\n          <b>Views</b>\n          ${views}\n        </p></li>\n        <li class=\"gallery__details-item\"><p class=\"gallery__details\">\n          <b>Comments</b>\n          ${comments}\n        </p></li>\n        <li class=\"gallery__details-item\"><p class=\"gallery__details\">\n          <b>Downloads</b>\n          ${downloads}\n        </p></li></ul>\n\n      </div>\n    </li>`\n    )\n    .join('');\n  return target.insertAdjacentHTML('beforeend', markup);\n};\n","import iziToast from 'izitoast ';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport NewApiPixabay from '@/js/apiPixabay';\nimport {\n  getValidateArray,\n  checkVisibleLoadMore,\n  scrollPage,\n} from '@/js/helpers';\nimport { refs } from './refs';\nimport { makeGalleryMarkup } from '@/service/markupService.js';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nconst newApiPixabay = new NewApiPixabay();\n\nconst getImages = async () => {\n  try {\n    const {\n      data: { totalHits, hits },\n    } = await newApiPixabay.fetchGallery();\n\n    if (totalHits === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n      });\n      return;\n    }\n\n    if (\n      !checkVisibleLoadMore({\n        totalHits,\n        page: newApiPixabay.page,\n        perPage: newApiPixabay.perPage,\n      })\n    ) {\n      refs.btnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'Oops',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      refs.btnLoadMore.style.display = 'flex';\n    }\n\n    makeGalleryMarkup(getValidateArray(hits), refs.gallery);\n    lightbox.refresh();\n    if (newApiPixabay.page === 1) {\n      iziToast.success({\n        title: 'Hooray!',\n        message: `We found ${totalHits} images.`,\n      });\n    } else {\n      scrollPage();\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst onSearchFormSubmit = async e => {\n  e.preventDefault();\n\n  if (refs.input.value.trim() === '') {\n    return;\n  }\n\n  refs.btnLoadMore.style.display = 'none';\n  newApiPixabay.resetPage();\n  refs.gallery.innerHTML = '';\n\n  newApiPixabay.valueForSearch = e.target.elements.searchQuery.value.trim();\n  getImages();\n};\n\nconst onLoadMoreClick = () => {\n  newApiPixabay.page += 1;\n  getImages();\n};\n\nrefs.form.addEventListener('submit', onSearchFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n"],"names":["NewApiPixabay","__privateAdd","_BASE_URL","_KEY","_valueForSearch","_page","__privateSet","axios","__privateGet","value","p","refs","getValidateArray","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","checkVisibleLoadMore","page","totalHits","perPage","scrollPage","cardHeight","makeGalleryMarkup","target","markup","lightbox","SimpleLightbox","newApiPixabay","getImages","hits","iziToast","err","onSearchFormSubmit","onLoadMoreClick"],"mappings":"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"}